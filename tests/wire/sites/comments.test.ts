// This file was auto-generated by Fern from our API Definition.

import * as Webflow from "../../../src/api/index";
import { WebflowClient } from "../../../src/Client";
import { mockServerPool } from "../../mock-server/MockServerPool";

describe("Comments", () => {
    test("list-comment-threads (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {
            comments: [
                {
                    id: "679d2ddb5196117ad04d1ffa",
                    siteId: "679826b3b20b045e176bc4b5",
                    pageId: "679826b3b20b045e176bc4bc",
                    localeId: "67993753d910db250db64b3e",
                    itemId: "580e64008c9a982ac9b8b754",
                    breakpoint: "main",
                    url: "https://webflow.com/design/site-slug-4ec832?workflow=comment&commentId=679d2ddb5196117ad04d1ff8&pageId=679826b3b20b045e176bc4bc",
                    content: "Let's go to the pub! [[6287ec36a841b25637c663df]] ",
                    isResolved: false,
                    author: {
                        userId: "6287ec36a841b25637c663df",
                        email: "ford.prefect@heartofgold.spaceship",
                        name: "Ford Prefect",
                    },
                    mentionedUsers: [
                        {
                            userId: "6287ec36a841b25637c663df",
                            email: "arthur.dent@heartofgold.spaceship",
                            name: "Arthur Dent",
                        },
                    ],
                    createdOn: "2025-01-31T20:08:59.759Z",
                    lastUpdated: "2025-01-31T20:08:59.759Z",
                },
                {
                    id: "679d2ddb5196117ad04d1ffc",
                    siteId: "679826b3b20b045e176bc4b5",
                    pageId: "679826b3b20b045e176bc4bc",
                    localeId: "67993753d910db250db64b3e",
                    itemId: "580e64008c9a982ac9b8b754",
                    breakpoint: "main",
                    url: "https://webflow.com/design/site-slug-4ec832?workflow=comment&commentId=679d2ddb5196117ad04d1ff8&pageId=679826b3b20b045e176bc4bc",
                    content: "You have five minutes left to drink it [[6287ec36a841b25637c663df]] ",
                    isResolved: false,
                    author: {
                        userId: "6287ec36a841b25637c663df",
                        email: "ford.prefect@heartofgold.spaceship",
                        name: "Ford Prefect",
                    },
                    mentionedUsers: [
                        {
                            userId: "6287ec36a841b25637c663df",
                            email: "arthur.dent@heartofgold.spaceship",
                            name: "Arthur Dent",
                        },
                    ],
                    createdOn: "2025-01-31T20:08:59.759Z",
                    lastUpdated: "2025-01-31T20:08:59.759Z",
                },
            ],
            pagination: { limit: 2, offset: 0, total: 2 },
        };
        server
            .mockEndpoint()
            .get("/sites/580e63e98c9a982ac9b8b741/comments")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sites.comments.listCommentThreads("580e63e98c9a982ac9b8b741", {
            localeId: "65427cf400e02b306eaa04a0",
            offset: 1.1,
            limit: 1.1,
            sortBy: "createdOn",
            sortOrder: "asc",
        });
        expect(response).toEqual({
            comments: [
                {
                    id: "679d2ddb5196117ad04d1ffa",
                    siteId: "679826b3b20b045e176bc4b5",
                    pageId: "679826b3b20b045e176bc4bc",
                    localeId: "67993753d910db250db64b3e",
                    itemId: "580e64008c9a982ac9b8b754",
                    breakpoint: "main",
                    url: "https://webflow.com/design/site-slug-4ec832?workflow=comment&commentId=679d2ddb5196117ad04d1ff8&pageId=679826b3b20b045e176bc4bc",
                    content: "Let's go to the pub! [[6287ec36a841b25637c663df]] ",
                    isResolved: false,
                    author: {
                        userId: "6287ec36a841b25637c663df",
                        email: "ford.prefect@heartofgold.spaceship",
                        name: "Ford Prefect",
                    },
                    mentionedUsers: [
                        {
                            userId: "6287ec36a841b25637c663df",
                            email: "arthur.dent@heartofgold.spaceship",
                            name: "Arthur Dent",
                        },
                    ],
                    createdOn: "2025-01-31T20:08:59.759Z",
                    lastUpdated: "2025-01-31T20:08:59.759Z",
                },
                {
                    id: "679d2ddb5196117ad04d1ffc",
                    siteId: "679826b3b20b045e176bc4b5",
                    pageId: "679826b3b20b045e176bc4bc",
                    localeId: "67993753d910db250db64b3e",
                    itemId: "580e64008c9a982ac9b8b754",
                    breakpoint: "main",
                    url: "https://webflow.com/design/site-slug-4ec832?workflow=comment&commentId=679d2ddb5196117ad04d1ff8&pageId=679826b3b20b045e176bc4bc",
                    content: "You have five minutes left to drink it [[6287ec36a841b25637c663df]] ",
                    isResolved: false,
                    author: {
                        userId: "6287ec36a841b25637c663df",
                        email: "ford.prefect@heartofgold.spaceship",
                        name: "Ford Prefect",
                    },
                    mentionedUsers: [
                        {
                            userId: "6287ec36a841b25637c663df",
                            email: "arthur.dent@heartofgold.spaceship",
                            name: "Arthur Dent",
                        },
                    ],
                    createdOn: "2025-01-31T20:08:59.759Z",
                    lastUpdated: "2025-01-31T20:08:59.759Z",
                },
            ],
            pagination: {
                limit: 2,
                offset: 0,
                total: 2,
            },
        });
    });

    test("list-comment-threads (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/sites/site_id/comments")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentThreads("site_id");
        }).rejects.toThrow(Webflow.BadRequestError);
    });

    test("list-comment-threads (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentThreads("site_id");
        }).rejects.toThrow(Webflow.UnauthorizedError);
    });

    test("list-comment-threads (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentThreads("site_id");
        }).rejects.toThrow(Webflow.NotFoundError);
    });

    test("list-comment-threads (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentThreads("site_id");
        }).rejects.toThrow(Webflow.TooManyRequestsError);
    });

    test("list-comment-threads (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentThreads("site_id");
        }).rejects.toThrow(Webflow.InternalServerError);
    });

    test("get-comment-thread (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {
            id: "580e64008c9a982ac9b8b754",
            siteId: "580e64008c9a982ac9b8b754",
            pageId: "580e64008c9a982ac9b8b754",
            localeId: "580e64008c9a982ac9b8b754",
            itemId: "580e64008c9a982ac9b8b754",
            breakpoint: "main",
            url: "https://webflow.com/design/site-slug-4ec832?workflow=comment&commentId=679d2ddb5196117ad04d1ff8&pageId=679826b3b20b045e176bc4bc",
            content: "This is a comment reply",
            isResolved: true,
            author: { userId: "userId", email: "email", name: "name" },
            mentionedUsers: [
                { userId: "6287ec36a841b25637c663df", email: "arthur.dent@heartofgold.spaceship", name: "Arthur Dent" },
            ],
            createdOn: "2023-03-17T18:47:35.560Z",
            lastUpdated: "2023-03-17T18:47:35.560Z",
        };
        server
            .mockEndpoint()
            .get("/sites/580e63e98c9a982ac9b8b741/comments/580e63e98c9a982ac9b8b741")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sites.comments.getCommentThread(
            "580e63e98c9a982ac9b8b741",
            "580e63e98c9a982ac9b8b741",
            {
                localeId: "65427cf400e02b306eaa04a0",
                offset: 1.1,
                limit: 1.1,
                sortBy: "createdOn",
                sortOrder: "asc",
            },
        );
        expect(response).toEqual({
            id: "580e64008c9a982ac9b8b754",
            siteId: "580e64008c9a982ac9b8b754",
            pageId: "580e64008c9a982ac9b8b754",
            localeId: "580e64008c9a982ac9b8b754",
            itemId: "580e64008c9a982ac9b8b754",
            breakpoint: "main",
            url: "https://webflow.com/design/site-slug-4ec832?workflow=comment&commentId=679d2ddb5196117ad04d1ff8&pageId=679826b3b20b045e176bc4bc",
            content: "This is a comment reply",
            isResolved: true,
            author: {
                userId: "userId",
                email: "email",
                name: "name",
            },
            mentionedUsers: [
                {
                    userId: "6287ec36a841b25637c663df",
                    email: "arthur.dent@heartofgold.spaceship",
                    name: "Arthur Dent",
                },
            ],
            createdOn: "2023-03-17T18:47:35.560Z",
            lastUpdated: "2023-03-17T18:47:35.560Z",
        });
    });

    test("get-comment-thread (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.getCommentThread("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.BadRequestError);
    });

    test("get-comment-thread (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.getCommentThread("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.UnauthorizedError);
    });

    test("get-comment-thread (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.getCommentThread("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.NotFoundError);
    });

    test("get-comment-thread (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.getCommentThread("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.TooManyRequestsError);
    });

    test("get-comment-thread (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.getCommentThread("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.InternalServerError);
    });

    test("list-comment-replies (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {
            comments: [
                {
                    id: "679d2ddb5196117ad04d1ffa",
                    commentId: "679d2ddb5196117ad04d1ff8",
                    siteId: "679826b3b20b045e176bc4b5",
                    pageId: "679826b3b20b045e176bc4bc",
                    localeId: "67993753d910db250db64b3e",
                    breakpoint: "main",
                    content: "This comment mentions another user [[6287ec36a841b25637c663df]] ",
                    isResolved: false,
                    author: { id: "id", email: "email", name: "name" },
                    mentionedUsers: [{ id: "id", email: "arthur.dent@example.com", name: "Arthur Dent" }],
                    lastUpdated: "2025-01-31T20:08:59.759Z",
                    createdOn: "2025-01-31T20:08:59.759Z",
                },
            ],
            pagination: { limit: 2, offset: 0, total: 1 },
        };
        server
            .mockEndpoint()
            .get("/sites/580e63e98c9a982ac9b8b741/comments/580e63e98c9a982ac9b8b741/replies")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sites.comments.listCommentReplies(
            "580e63e98c9a982ac9b8b741",
            "580e63e98c9a982ac9b8b741",
            {
                localeId: "65427cf400e02b306eaa04a0",
                offset: 1.1,
                limit: 1.1,
                sortBy: "createdOn",
                sortOrder: "asc",
            },
        );
        expect(response).toEqual({
            comments: [
                {
                    id: "679d2ddb5196117ad04d1ffa",
                    commentId: "679d2ddb5196117ad04d1ff8",
                    siteId: "679826b3b20b045e176bc4b5",
                    pageId: "679826b3b20b045e176bc4bc",
                    localeId: "67993753d910db250db64b3e",
                    breakpoint: "main",
                    content: "This comment mentions another user [[6287ec36a841b25637c663df]] ",
                    isResolved: false,
                    author: {
                        id: "id",
                        email: "email",
                        name: "name",
                    },
                    mentionedUsers: [
                        {
                            id: "id",
                            email: "arthur.dent@example.com",
                            name: "Arthur Dent",
                        },
                    ],
                    lastUpdated: "2025-01-31T20:08:59.759Z",
                    createdOn: "2025-01-31T20:08:59.759Z",
                },
            ],
            pagination: {
                limit: 2,
                offset: 0,
                total: 1,
            },
        });
    });

    test("list-comment-replies (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id/replies")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentReplies("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.BadRequestError);
    });

    test("list-comment-replies (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id/replies")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentReplies("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.UnauthorizedError);
    });

    test("list-comment-replies (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id/replies")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentReplies("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.NotFoundError);
    });

    test("list-comment-replies (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id/replies")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentReplies("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.TooManyRequestsError);
    });

    test("list-comment-replies (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/sites/site_id/comments/comment_thread_id/replies")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sites.comments.listCommentReplies("site_id", "comment_thread_id");
        }).rejects.toThrow(Webflow.InternalServerError);
    });
});
