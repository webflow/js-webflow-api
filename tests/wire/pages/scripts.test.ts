// This file was auto-generated by Fern from our API Definition.

import * as Webflow from "../../../src/api/index";
import { WebflowClient } from "../../../src/Client";
import { mockServerPool } from "../../mock-server/MockServerPool";

describe("Scripts", () => {
    test("get-custom-code (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {
            scripts: [{ id: "id", location: "header", version: "version", attributes: { key: "value" } }],
            lastUpdated: "lastUpdated",
            createdOn: "createdOn",
        };
        server
            .mockEndpoint()
            .get("/pages/63c720f9347c2139b248e552/custom_code")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.pages.scripts.getCustomCode("63c720f9347c2139b248e552");
        expect(response).toEqual({
            scripts: [
                {
                    id: "id",
                    location: "header",
                    version: "version",
                    attributes: {
                        key: "value",
                    },
                },
            ],
            lastUpdated: "lastUpdated",
            createdOn: "createdOn",
        });
    });

    test("get-custom-code (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.getCustomCode("page_id");
        }).rejects.toThrow(Webflow.BadRequestError);
    });

    test("get-custom-code (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.getCustomCode("page_id");
        }).rejects.toThrow(Webflow.UnauthorizedError);
    });

    test("get-custom-code (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.getCustomCode("page_id");
        }).rejects.toThrow(Webflow.NotFoundError);
    });

    test("get-custom-code (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.getCustomCode("page_id");
        }).rejects.toThrow(Webflow.TooManyRequestsError);
    });

    test("get-custom-code (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .get("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.getCustomCode("page_id");
        }).rejects.toThrow(Webflow.InternalServerError);
    });

    test("upsert-custom-code (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });
        const rawRequestBody = {
            scripts: [
                {
                    id: "cms_slider",
                    location: "header",
                    version: "1.0.0",
                    attributes: { "my-attribute": "some-value" },
                },
                { id: "alert", location: "header", version: "0.0.1" },
            ],
        };
        const rawResponseBody = {
            scripts: [
                {
                    id: "cms_slider",
                    location: "header",
                    version: "1.0.0",
                    attributes: { "my-attribute": "some-value" },
                },
                { id: "alert", location: "header", version: "0.0.1", attributes: { key: "value" } },
            ],
            lastUpdated: "2022-10-26T00:28:54.191Z",
            createdOn: "2022-10-26T00:28:54.191Z",
        };
        server
            .mockEndpoint()
            .put("/pages/63c720f9347c2139b248e552/custom_code")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.pages.scripts.upsertCustomCode("63c720f9347c2139b248e552", {
            scripts: [
                {
                    id: "cms_slider",
                    location: "header",
                    version: "1.0.0",
                    attributes: {
                        "my-attribute": "some-value",
                    },
                },
                {
                    id: "alert",
                    location: "header",
                    version: "0.0.1",
                },
            ],
        });
        expect(response).toEqual({
            scripts: [
                {
                    id: "cms_slider",
                    location: "header",
                    version: "1.0.0",
                    attributes: {
                        "my-attribute": "some-value",
                    },
                },
                {
                    id: "alert",
                    location: "header",
                    version: "0.0.1",
                    attributes: {
                        key: "value",
                    },
                },
            ],
            lastUpdated: "2022-10-26T00:28:54.191Z",
            createdOn: "2022-10-26T00:28:54.191Z",
        });
    });

    test("upsert-custom-code (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/pages/page_id/custom_code")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.upsertCustomCode("page_id", {});
        }).rejects.toThrow(Webflow.BadRequestError);
    });

    test("upsert-custom-code (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });
        const rawRequestBody = {};
        const rawResponseBody = {};
        server
            .mockEndpoint()
            .put("/pages/page_id/custom_code")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.upsertCustomCode("page_id", {});
        }).rejects.toThrow(Webflow.UnauthorizedError);
    });

    test("upsert-custom-code (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });
        const rawRequestBody = {};
        const rawResponseBody = {};
        server
            .mockEndpoint()
            .put("/pages/page_id/custom_code")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.upsertCustomCode("page_id", {});
        }).rejects.toThrow(Webflow.NotFoundError);
    });

    test("upsert-custom-code (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/pages/page_id/custom_code")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(409)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.upsertCustomCode("page_id", {});
        }).rejects.toThrow(Webflow.ConflictError);
    });

    test("upsert-custom-code (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });
        const rawRequestBody = {};
        const rawResponseBody = {};
        server
            .mockEndpoint()
            .put("/pages/page_id/custom_code")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.upsertCustomCode("page_id", {});
        }).rejects.toThrow(Webflow.TooManyRequestsError);
    });

    test("upsert-custom-code (7)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });
        const rawRequestBody = {};
        const rawResponseBody = {};
        server
            .mockEndpoint()
            .put("/pages/page_id/custom_code")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.upsertCustomCode("page_id", {});
        }).rejects.toThrow(Webflow.InternalServerError);
    });

    test("delete-custom-code (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        server
            .mockEndpoint()
            .delete("/pages/63c720f9347c2139b248e552/custom_code")
            .respondWith()
            .statusCode(200)
            .build();

        const response = await client.pages.scripts.deleteCustomCode("63c720f9347c2139b248e552");
        expect(response).toEqual(undefined);
    });

    test("delete-custom-code (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .delete("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.deleteCustomCode("page_id");
        }).rejects.toThrow(Webflow.BadRequestError);
    });

    test("delete-custom-code (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .delete("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.deleteCustomCode("page_id");
        }).rejects.toThrow(Webflow.UnauthorizedError);
    });

    test("delete-custom-code (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .delete("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.deleteCustomCode("page_id");
        }).rejects.toThrow(Webflow.NotFoundError);
    });

    test("delete-custom-code (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .delete("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.deleteCustomCode("page_id");
        }).rejects.toThrow(Webflow.TooManyRequestsError);
    });

    test("delete-custom-code (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: { base: server.baseUrl, dataApi: server.baseUrl, contentDeliveryApi: server.baseUrl },
        });

        const rawResponseBody = {};
        server
            .mockEndpoint()
            .delete("/pages/page_id/custom_code")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.pages.scripts.deleteCustomCode("page_id");
        }).rejects.toThrow(Webflow.InternalServerError);
    });
});
