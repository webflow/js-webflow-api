/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../mock-server/MockServerPool.js";
import { WebflowClient } from "../../src/Client";

describe("Assets", () => {
    test("list", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: {
                base: server.baseUrl,
                dataApi: server.baseUrl,
                contentDeliveryApi: server.baseUrl,
                production: server.baseUrl,
                cdn: server.baseUrl,
            },
        });

        const rawResponseBody = {
            assets: [
                {
                    id: "63e5889e7fe4eafa7384cea4",
                    contentType: "image/png",
                    size: 2212772,
                    siteId: "63938b302ea6b0aa6f3d8745",
                    hostedUrl:
                        "https://s3.amazonaws.com/webflow-prod-assets/63938b302ea6b0aa6f3d8745/63e5889e7fe4eafa7384cea4_Vectors-Wrapper.svg",
                    originalFileName: "Candy-Wrapper.svg",
                    displayName: "63e5889e7fe4eafa7384cea4_Candy-Wrapper.png",
                    lastUpdated: "2023-03-01T23:42:57Z",
                    createdOn: "2023-02-09T23:58:22Z",
                    variants: [
                        {
                            hostedUrl:
                                "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            originalFileName: "Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            displayName:
                                "660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            format: "png",
                            width: 500,
                            height: 900,
                            quality: 100,
                        },
                    ],
                    altText: "A single candy wrapper",
                },
                {
                    id: "63e5889e7fe4eafa7384cea5",
                    contentType: "image/png",
                    size: 2212772,
                    siteId: "63938b302ea6b0aa6f3d8745",
                    hostedUrl:
                        "https://s3.amazonaws.com/webflow-prod-assets/63938b302ea6b0aa6f3d8745/63e5889e7fe4eafa7384cea4_Vectors-Wrapper.svg",
                    originalFileName: "Gum-Wrapper.svg",
                    displayName: "63e5889e7fe4eafa7384cea5_Gum-Wrapper.png",
                    lastUpdated: "2023-03-01T23:42:57Z",
                    createdOn: "2023-02-09T23:58:22Z",
                    variants: [
                        {
                            hostedUrl:
                                "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            originalFileName: "Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            displayName:
                                "660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            format: "png",
                            width: 500,
                            height: 900,
                            quality: 100,
                        },
                    ],
                    altText: "A single gum wrapper",
                },
            ],
            pagination: { limit: 2, offset: 0, total: 2 },
        };
        server
            .mockEndpoint()
            .get("/sites/580e63e98c9a982ac9b8b741/assets")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.assets.list("580e63e98c9a982ac9b8b741");
        expect(response).toEqual({
            assets: [
                {
                    id: "63e5889e7fe4eafa7384cea4",
                    contentType: "image/png",
                    size: 2212772,
                    siteId: "63938b302ea6b0aa6f3d8745",
                    hostedUrl:
                        "https://s3.amazonaws.com/webflow-prod-assets/63938b302ea6b0aa6f3d8745/63e5889e7fe4eafa7384cea4_Vectors-Wrapper.svg",
                    originalFileName: "Candy-Wrapper.svg",
                    displayName: "63e5889e7fe4eafa7384cea4_Candy-Wrapper.png",
                    lastUpdated: new Date("2023-03-01T23:42:57.000Z"),
                    createdOn: new Date("2023-02-09T23:58:22.000Z"),
                    variants: [
                        {
                            hostedUrl:
                                "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            originalFileName: "Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            displayName:
                                "660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            format: "png",
                            width: 500,
                            height: 900,
                            quality: 100,
                        },
                    ],
                    altText: "A single candy wrapper",
                },
                {
                    id: "63e5889e7fe4eafa7384cea5",
                    contentType: "image/png",
                    size: 2212772,
                    siteId: "63938b302ea6b0aa6f3d8745",
                    hostedUrl:
                        "https://s3.amazonaws.com/webflow-prod-assets/63938b302ea6b0aa6f3d8745/63e5889e7fe4eafa7384cea4_Vectors-Wrapper.svg",
                    originalFileName: "Gum-Wrapper.svg",
                    displayName: "63e5889e7fe4eafa7384cea5_Gum-Wrapper.png",
                    lastUpdated: new Date("2023-03-01T23:42:57.000Z"),
                    createdOn: new Date("2023-02-09T23:58:22.000Z"),
                    variants: [
                        {
                            hostedUrl:
                                "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            originalFileName: "Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            displayName:
                                "660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                            format: "png",
                            width: 500,
                            height: 900,
                            quality: 100,
                        },
                    ],
                    altText: "A single gum wrapper",
                },
            ],
            pagination: {
                limit: 2,
                offset: 0,
                total: 2,
            },
        });
    });

    test("create", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: {
                base: server.baseUrl,
                dataApi: server.baseUrl,
                contentDeliveryApi: server.baseUrl,
                production: server.baseUrl,
                cdn: server.baseUrl,
            },
        });
        const rawRequestBody = { fileName: "file.png", fileHash: "3c7d87c9575702bc3b1e991f4d3c638e" };
        const rawResponseBody = {
            uploadDetails: {
                acl: "public-read",
                bucket: "webflow-bucket-name",
                "X-Amz-Algorithm": "AWS4-HMAC-SHA256",
                "X-Amz-Credential": "<credential-key>/<date>/<region-zone>/s3/aws4_request",
                "X-Amz-Date": "<date-in-iso-like-string>",
                key: "<siteId>/<fileId>_<filename-with-extension>",
                Policy: "<a-very-long-alphanumeric-token-with-equal-sign-at-the-end>",
                "X-Amz-Signature": "<one-line-ling-alphanumeric-signature>",
                success_action_status: "201",
                "content-type": "image/png",
                "Cache-Control": "max-age=31536000, must-revalidate",
            },
            contentType: "image/png",
            id: "64358b9544249dc43d37d2b7",
            parentFolder: "6436b1ce5281cace05b65aea",
            uploadUrl:
                "https://s3.amazonaws.com/webflow-dev-assets/643021114e290e0d3a0602b2/64358b9544249dc43d37d2b7_Screenshot%202023-04-11%20at%209.50.42%20AM.png",
            assetUrl:
                "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d907ab9e91e3e9f56385e_paranoidAndroid-2024.png",
            hostedUrl:
                "https://dev-assets.website-files.com/643021114e290e0d3a0602b2/64358b9544249dc43d37d2b7_Screenshot%202023-04-11%20at%209.50.42%20AM.png",
            originalFileName: "file.png",
            createdOn: "2023-04-11T16:32:21Z",
            lastUpdated: "2023-04-12T20:31:03Z",
        };
        server
            .mockEndpoint()
            .post("/sites/580e63e98c9a982ac9b8b741/assets")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.assets.create("580e63e98c9a982ac9b8b741", {
            fileName: "file.png",
            fileHash: "3c7d87c9575702bc3b1e991f4d3c638e",
        });
        expect(response).toEqual({
            uploadDetails: {
                acl: "public-read",
                bucket: "webflow-bucket-name",
                xAmzAlgorithm: "AWS4-HMAC-SHA256",
                xAmzCredential: "<credential-key>/<date>/<region-zone>/s3/aws4_request",
                xAmzDate: "<date-in-iso-like-string>",
                key: "<siteId>/<fileId>_<filename-with-extension>",
                policy: "<a-very-long-alphanumeric-token-with-equal-sign-at-the-end>",
                xAmzSignature: "<one-line-ling-alphanumeric-signature>",
                successActionStatus: "201",
                contentType: "image/png",
                cacheControl: "max-age=31536000, must-revalidate",
            },
            contentType: "image/png",
            id: "64358b9544249dc43d37d2b7",
            parentFolder: "6436b1ce5281cace05b65aea",
            uploadUrl:
                "https://s3.amazonaws.com/webflow-dev-assets/643021114e290e0d3a0602b2/64358b9544249dc43d37d2b7_Screenshot%202023-04-11%20at%209.50.42%20AM.png",
            assetUrl:
                "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d907ab9e91e3e9f56385e_paranoidAndroid-2024.png",
            hostedUrl:
                "https://dev-assets.website-files.com/643021114e290e0d3a0602b2/64358b9544249dc43d37d2b7_Screenshot%202023-04-11%20at%209.50.42%20AM.png",
            originalFileName: "file.png",
            createdOn: new Date("2023-04-11T16:32:21.000Z"),
            lastUpdated: new Date("2023-04-12T20:31:03.000Z"),
        });
    });

    test("get", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: {
                base: server.baseUrl,
                dataApi: server.baseUrl,
                contentDeliveryApi: server.baseUrl,
                production: server.baseUrl,
                cdn: server.baseUrl,
            },
        });

        const rawResponseBody = {
            id: "63e5889e7fe4eafa7384cea4",
            contentType: "image/png",
            size: 2212772,
            siteId: "63938b302ea6b0aa6f3d8745",
            hostedUrl:
                "https://s3.amazonaws.com/webflow-prod-assets/63938b302ea6b0aa6f3d8745/63e5889e7fe4eafa7384cea4_Vectors-Wrapper.svg",
            originalFileName: "Candy-Wrapper.svg",
            displayName: "63e5889e7fe4eafa7384cea4_Candy-Wrapper.png",
            lastUpdated: "2023-03-01T23:42:57Z",
            createdOn: "2023-02-09T23:58:22Z",
            variants: [
                {
                    hostedUrl:
                        "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    originalFileName: "Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    displayName: "660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    format: "png",
                    width: 500,
                    height: 900,
                    quality: 100,
                },
            ],
            altText: "A single candy wrapper",
        };
        server
            .mockEndpoint()
            .get("/assets/580e63fc8c9a982ac9b8b745")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.assets.get("580e63fc8c9a982ac9b8b745");
        expect(response).toEqual({
            id: "63e5889e7fe4eafa7384cea4",
            contentType: "image/png",
            size: 2212772,
            siteId: "63938b302ea6b0aa6f3d8745",
            hostedUrl:
                "https://s3.amazonaws.com/webflow-prod-assets/63938b302ea6b0aa6f3d8745/63e5889e7fe4eafa7384cea4_Vectors-Wrapper.svg",
            originalFileName: "Candy-Wrapper.svg",
            displayName: "63e5889e7fe4eafa7384cea4_Candy-Wrapper.png",
            lastUpdated: new Date("2023-03-01T23:42:57.000Z"),
            createdOn: new Date("2023-02-09T23:58:22.000Z"),
            variants: [
                {
                    hostedUrl:
                        "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    originalFileName: "Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    displayName: "660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    format: "png",
                    width: 500,
                    height: 900,
                    quality: 100,
                },
            ],
            altText: "A single candy wrapper",
        });
    });

    test("delete", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: {
                base: server.baseUrl,
                dataApi: server.baseUrl,
                contentDeliveryApi: server.baseUrl,
                production: server.baseUrl,
                cdn: server.baseUrl,
            },
        });

        server.mockEndpoint().delete("/assets/580e63fc8c9a982ac9b8b745").respondWith().statusCode(200).build();

        const response = await client.assets.delete("580e63fc8c9a982ac9b8b745");
        expect(response).toEqual(undefined);
    });

    test("update", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: {
                base: server.baseUrl,
                dataApi: server.baseUrl,
                contentDeliveryApi: server.baseUrl,
                production: server.baseUrl,
                cdn: server.baseUrl,
            },
        });
        const rawRequestBody = {};
        const rawResponseBody = {
            id: "63e5889e7fe4eafa7384cea4",
            contentType: "image/png",
            size: 2212772,
            siteId: "63938b302ea6b0aa6f3d8745",
            hostedUrl:
                "https://s3.amazonaws.com/webflow-prod-assets/63938b302ea6b0aa6f3d8745/63e5889e7fe4eafa7384cea4_Vectors-Wrapper.svg",
            originalFileName: "Candy-Wrapper.svg",
            displayName: "63e5889e7fe4eafa7384cea4_Candy-Wrapper.png",
            lastUpdated: "2023-03-01T23:42:57Z",
            createdOn: "2023-02-09T23:58:22Z",
            variants: [
                {
                    hostedUrl:
                        "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    originalFileName: "Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    displayName: "660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    format: "png",
                    width: 500,
                    height: 900,
                    quality: 100,
                },
            ],
            altText: "A single candy wrapper",
        };
        server
            .mockEndpoint()
            .patch("/assets/580e63fc8c9a982ac9b8b745")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.assets.update("580e63fc8c9a982ac9b8b745");
        expect(response).toEqual({
            id: "63e5889e7fe4eafa7384cea4",
            contentType: "image/png",
            size: 2212772,
            siteId: "63938b302ea6b0aa6f3d8745",
            hostedUrl:
                "https://s3.amazonaws.com/webflow-prod-assets/63938b302ea6b0aa6f3d8745/63e5889e7fe4eafa7384cea4_Vectors-Wrapper.svg",
            originalFileName: "Candy-Wrapper.svg",
            displayName: "63e5889e7fe4eafa7384cea4_Candy-Wrapper.png",
            lastUpdated: new Date("2023-03-01T23:42:57.000Z"),
            createdOn: new Date("2023-02-09T23:58:22.000Z"),
            variants: [
                {
                    hostedUrl:
                        "https://s3.amazonaws.com/webflow-prod-assets/6258612d1ee792848f805dcf/660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    originalFileName: "Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    displayName: "660d83ce30f3a599ddb0bdb3_Screenshot%202024-03-20%20at%209.03.24%E2%80%AFPM-p-500.png",
                    format: "png",
                    width: 500,
                    height: 900,
                    quality: 100,
                },
            ],
            altText: "A single candy wrapper",
        });
    });

    test("list-folders", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: {
                base: server.baseUrl,
                dataApi: server.baseUrl,
                contentDeliveryApi: server.baseUrl,
                production: server.baseUrl,
                cdn: server.baseUrl,
            },
        });

        const rawResponseBody = {
            assetFolders: [
                {
                    id: "6390c49774a71f0e3c1a08ee",
                    displayName: "emoji icons",
                    assets: ["63e5889e7fe4eafa7384cea4", "659595234426a9fcbad57043"],
                    siteId: "6390c49674a71f84b51a08d8",
                    createdOn: "2018-10-14T21:55:49Z",
                    lastUpdated: "2022-12-07T16:51:37Z",
                },
            ],
            pagination: { limit: 1, offset: 0, total: 1 },
        };
        server
            .mockEndpoint()
            .get("/sites/580e63e98c9a982ac9b8b741/asset_folders")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.assets.listFolders("580e63e98c9a982ac9b8b741");
        expect(response).toEqual({
            assetFolders: [
                {
                    id: "6390c49774a71f0e3c1a08ee",
                    displayName: "emoji icons",
                    assets: ["63e5889e7fe4eafa7384cea4", "659595234426a9fcbad57043"],
                    siteId: "6390c49674a71f84b51a08d8",
                    createdOn: new Date("2018-10-14T21:55:49.000Z"),
                    lastUpdated: new Date("2022-12-07T16:51:37.000Z"),
                },
            ],
            pagination: {
                limit: 1,
                offset: 0,
                total: 1,
            },
        });
    });

    test("create-folder", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: {
                base: server.baseUrl,
                dataApi: server.baseUrl,
                contentDeliveryApi: server.baseUrl,
                production: server.baseUrl,
                cdn: server.baseUrl,
            },
        });
        const rawRequestBody = { displayName: "my asset folder" };
        const rawResponseBody = {
            id: "6390c49774a71f0e3c1a08ee",
            displayName: "emoji icons",
            parentFolder: "6390c49774a71f99f21a08eb",
            assets: ["63e5889e7fe4eafa7384cea4", "659595234426a9fcbad57043"],
            siteId: "6390c49674a71f84b51a08d8",
            createdOn: "2018-10-14T21:55:49Z",
            lastUpdated: "2022-12-07T16:51:37Z",
        };
        server
            .mockEndpoint()
            .post("/sites/580e63e98c9a982ac9b8b741/asset_folders")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.assets.createFolder("580e63e98c9a982ac9b8b741", {
            displayName: "my asset folder",
        });
        expect(response).toEqual({
            id: "6390c49774a71f0e3c1a08ee",
            displayName: "emoji icons",
            parentFolder: "6390c49774a71f99f21a08eb",
            assets: ["63e5889e7fe4eafa7384cea4", "659595234426a9fcbad57043"],
            siteId: "6390c49674a71f84b51a08d8",
            createdOn: new Date("2018-10-14T21:55:49.000Z"),
            lastUpdated: new Date("2022-12-07T16:51:37.000Z"),
        });
    });

    test("get-folder", async () => {
        const server = mockServerPool.createServer();
        const client = new WebflowClient({
            accessToken: "test",
            environment: {
                base: server.baseUrl,
                dataApi: server.baseUrl,
                contentDeliveryApi: server.baseUrl,
                production: server.baseUrl,
                cdn: server.baseUrl,
            },
        });

        const rawResponseBody = {
            id: "6390c49774a71f0e3c1a08ee",
            displayName: "emoji icons",
            parentFolder: "6390c49774a71f99f21a08eb",
            assets: ["63e5889e7fe4eafa7384cea4", "659595234426a9fcbad57043"],
            siteId: "6390c49674a71f84b51a08d8",
            createdOn: "2018-10-14T21:55:49Z",
            lastUpdated: "2022-12-07T16:51:37Z",
        };
        server
            .mockEndpoint()
            .get("/asset_folders/6390c49774a71f0e3c1a08ee")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.assets.getFolder("6390c49774a71f0e3c1a08ee");
        expect(response).toEqual({
            id: "6390c49774a71f0e3c1a08ee",
            displayName: "emoji icons",
            parentFolder: "6390c49774a71f99f21a08eb",
            assets: ["63e5889e7fe4eafa7384cea4", "659595234426a9fcbad57043"],
            siteId: "6390c49674a71f84b51a08d8",
            createdOn: new Date("2018-10-14T21:55:49.000Z"),
            lastUpdated: new Date("2022-12-07T16:51:37.000Z"),
        });
    });
});
